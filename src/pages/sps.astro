---
import Layout from '../layouts/Layout.astro';
---

<style>
  .get-started-form-container {
    background: #fff;
    border-radius: 1.5rem;
    box-shadow: 0 4px 24px 0 rgba(0,0,0,0.04);
    padding: 1.75rem 2.5rem 3.5rem 2.5rem; /* reduced top padding by 30% */
    max-width: 500px;
    width: 100%;
    margin: 8rem auto 0 auto;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-top: 4rem;
  }
  /* Reduce top padding of hero section just for this page */
  .hero.hero-fullscreen {
    padding-top: 0 !important;
    margin-top: -2rem !important;
  }
  
  /* Reduce header padding just for this page */
  .header {
    padding: 0 !important;
    margin-bottom: -1rem !important;
  }
  
  /* Also target the navbar specifically */
  .navbar {
    padding: 0 !important;
  }
  
  /* Target the nav-content as well */
  .nav-content {
    padding: 0 !important;
  }
  .get-started-form {
    width: 100%;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .get-started-form label {
    font-family: 'Outfit', sans-serif;
    font-size: 1rem;
    color: #23221F;
    margin-bottom: 0.5rem;
    display: block;
    font-weight: 400;
    text-align: left;
    width: 100%;
    max-width: 370px;
    margin-left: auto;
    margin-right: auto;
  }
  .get-started-form input[type="text"],
  .get-started-form input[type="email"],
  .get-started-form input[type="tel"],
  .get-started-form select {
    width: 100%;
    max-width: 370px;
    padding: 1.1rem 1.2rem;
    border-radius: 0.7rem;
    border: 1px solid #e0e0e0;
    background: #fff;
    font-size: 1.15rem;
    margin-bottom: 0.5rem;
    font-family: 'Outfit', sans-serif;
    color: #23221F;
    box-shadow: 0 2px 8px 0 rgba(0,0,0,0.04);
    outline: none;
    transition: box-shadow 0.2s, border 0.2s;
    display: block;
    margin-left: auto;
    margin-right: auto;
    text-align: left;
  }
  .get-started-form input[type="text"]::placeholder,
  .get-started-form input[type="email"]::placeholder,
  .get-started-form input[type="tel"]::placeholder {
    color: #c7c7c7;
    opacity: 1;
    font-weight: 400;
  }
  .get-started-form input[type="text"]:focus,
  .get-started-form input[type="email"]:focus,
  .get-started-form input[type="tel"]:focus,
  .get-started-form select:focus,
  .get-started-form textarea:focus {
    box-shadow: 0 0 0 2px #ff8661;
    border: 1px solid #ff8661;
    outline: none;
  }
  .get-started-form button {
    background: #ff8661;
    color: #fff;
    font-family: 'Outfit', sans-serif;
    font-size: 1.1rem;
    font-weight: 500;
    border: none;
    border-radius: 2rem;
    padding: 1.1rem 2.8rem;
    margin-top: 0.5rem;
    margin-bottom: 2.5rem;
    cursor: pointer;
    transition: background 0.2s;
    box-shadow: 0 2px 8px 0 rgba(0,0,0,0.03);
    display: block;
    margin-left: auto;
    margin-right: auto;
  }
  .get-started-form button:hover {
    background: #ff6a3d;
  }
  .get-started-form .form-group {
    width: 100%;
    margin-bottom: 0.8rem;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  .get-started-form .honeypot {
    display: none;
  }
  .error-message {
    color: #dc3545;
    font-size: 0.9rem;
    margin-top: 0.5rem;
    font-family: 'Outfit', sans-serif;
    text-align: left;
    width: 100%;
    max-width: 370px;
    margin-left: auto;
    margin-right: auto;
    min-height: 1.2rem;
  }
  .get-started-form input.error {
    border: 1px solid #dc3545;
    box-shadow: 0 0 0 2px rgba(220, 53, 69, 0.2);
  }
  input::placeholder, textarea::placeholder {
    font-weight: 400 !important;
    color: #888;
    opacity: 1;
  }
  .get-started-form-container button[type="submit"] {
    margin-bottom: 0 !important;
  }
  .get-started-form-container form {
    padding-top: 2rem;
  }
  .get-started-form select {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><polygon points="6,9 12,15 18,9" fill="black"/></svg>');
    background-repeat: no-repeat;
    background-position: calc(100% - 10px) center;
    background-size: 24px 24px;
    padding-right: 2.5rem;
  }
  @media (max-width: 600px) {
    .get-started-form-container {
      padding: 1.5rem 0.5rem 2.5rem 0.5rem;
      max-width: 98vw;
    }
  }
</style>

<Layout title="Claim Your 20% Startup People Summit Discount | Hoogly" description="Unlock your exclusive Startup People Summit discount and turn employee feedback into real culture change.">
  <section class="hero hero-fullscreen">
    <div class="container">
      <div class="hero-content">
        <div class="hero-text">
          <!-- Logo section above headline -->
          <div style="display: flex; justify-content: center; align-items: center; gap: 2rem; margin-bottom: 1.2rem; margin-top: 0.6rem;">
            <img src="/hoogly-logo.png" alt="Hoogly Logo" style="height: 48px; width: auto; background: transparent;" />
            <img src="/images/sps-logo.svg" alt="Startup People Summit Logo" style="height: 96px; width: auto; background: transparent;" />
          </div>
          
          <div class="hero-title" style="text-align: center; margin-bottom: 1.2rem; font-family: 'Outfit', sans-serif; font-size: 3.08rem;">
            <div class="hero-title-align" style="display: block;">
              Get your free Hoogly T-shirt<br>+ 20% discount voucher
            </div>
          </div>
          
          <!-- Claim by date tag -->
          <div style="text-align: center; margin-bottom: 2rem;">
            <span style="display: inline-block; background: #FCF4E3; color: #23221F; font-size: 0.95rem; font-weight: 400; border-radius: 999px; padding: 0.5em 1.2em; font-family: 'Outfit', sans-serif; letter-spacing: 0.02em; border: 1.5px solid #23221F;">Offer Expires 31st Aug 2025</span>
          </div>
          
          <!-- Inserted get-started form below headline, now using the same structure as /get-started -->
          <div class="get-started-form-container" style="margin-bottom: 3.5rem; margin-top: 2.5rem;">
            <form class="get-started-form" id="getStartedForm" autocomplete="off" novalidate>
              <div class="form-group">
                <label for="tshirtSize">T-shirt Size *</label>
                <select id="tshirtSize" name="tshirtSize" required>
                  <option value="">Select your size</option>
                  <option value="S">S</option>
                  <option value="M">M</option>
                  <option value="L">L</option>
                  <option value="XL">XL</option>
                </select>
                <div class="error-message" id="tshirtSize-error"></div>
              </div>
              <div class="form-group">
                <label for="name">Name *</label>
                <input type="text" id="name" name="name" placeholder="Jane Doe" required />
                <div class="error-message" id="name-error"></div>
              </div>
              <div class="form-group">
                <label for="email">Company Email *</label>
                <input type="email" id="email" name="email" placeholder="janedoe@hoogly.com" required />
                <div class="error-message" id="email-error"></div>
              </div>
              <div class="form-group">
                <label for="phone">Phone Number</label>
                <input type="tel" id="phone" name="phone" placeholder="+61 400 123 456" />
                <div class="error-message" id="phone-error"></div>
              </div>
              <div class="honeypot">
                <label for="website">Website</label>
                <input type="text" id="website" name="website" tabindex="-1" autocomplete="off" />
              </div>
              <input type="hidden" id="referrer" name="referrer" />
              <input type="hidden" id="buttonLabel" name="buttonLabel" />
              <input type="hidden" id="pageSource" name="pageSource" />
              <button type="submit">Get my T-shirt and discount</button>
            </form>
          </div>
          

          
          <!-- Offer details below the form, outside the white box -->
          <div style="max-width: 500px; margin: 0.5rem auto 0 auto;">
            <div class="anonymous-ai-headline" style="margin-bottom: 0.5rem; font-size: 2rem; font-weight: 400;">Offer Details</div>
            <ul class="anonymous-ai-subheadline" style="padding-left: 1.2em; margin: 0 0 0.5em 0; font-size: 1.15rem; color: #444; text-align: left;">
              <li>Offer valid for Startup People Summit attendees only</li>
              <li>You can activate your 20% discount anytime within the next 12 months</li>
              <li>Discount applies to your first annual plan or first 12 months of monthly billing</li>
              <li>One redemption per company</li>
              <li>Not valid with any other promotions or existing contracts</li>
              <li>This offer is non-transferable and can't be shared or passed on to others.</li>
            </ul>
          </div>
          
          <div style="height: 4rem;"></div>
        </div>
      </div>
    </div>
  </section>
  <script>
    document.addEventListener("astro:page-load", function () {
      // Set up form parameters
      const referrerInput = document.getElementById('referrer') as HTMLInputElement | null;
      if (referrerInput) referrerInput.value = document.referrer;
      const urlParams = new URLSearchParams(window.location.search);
      const buttonLabel = urlParams.get('button-label') || '';
      const buttonLabelInput = document.getElementById('buttonLabel') as HTMLInputElement | null;
      if (buttonLabelInput) buttonLabelInput.value = buttonLabel;
      const pageSource = urlParams.get('page-source') || '';
      const pageSourceInput = document.getElementById('pageSource') as HTMLInputElement | null;
      if (pageSourceInput) pageSourceInput.value = pageSource;

      // Trigger highlight animation
      const highlight = document.querySelector('.hero-highlight');
      if (highlight) {
        setTimeout(() => highlight.classList.add('animated'), 200);
      }


    });

    const form = document.getElementById('getStartedForm') as HTMLFormElement | null;
    console.log('Form found:', form);
    if (form) {
      // Clear error messages when user starts typing
      const inputs = form.querySelectorAll('input[type="text"], input[type="email"], input[type="tel"], select');
      inputs.forEach(input => {
        input.addEventListener('input', function(this: HTMLInputElement) {
          const fieldName = this.name;
          const errorElement = document.getElementById(`${fieldName}-error`);
          if (errorElement) {
            errorElement.textContent = '';
          }
          this.classList.remove('error');
        });
      });

      // Clear error messages when user changes select
      const selects = form.querySelectorAll('select');
      selects.forEach(select => {
        select.addEventListener('change', function(this: HTMLSelectElement) {
          const fieldName = this.name;
          const errorElement = document.getElementById(`${fieldName}-error`);
          if (errorElement) {
            errorElement.textContent = '';
          }
          this.classList.remove('error');
        });
      });

      form.addEventListener('submit', async function(e) {
        console.log('Form submitted!');
        e.preventDefault();
        
        // Clear previous errors
        const errorElements = form.querySelectorAll('.error-message');
        errorElements.forEach(el => (el as HTMLElement).textContent = '');
        const inputElements = form.querySelectorAll('input');
        inputElements.forEach(el => (el as HTMLInputElement).classList.remove('error'));

        const websiteInput = document.getElementById('website') as HTMLInputElement | null;
        if (websiteInput && websiteInput.value) return;

        const nameInput = document.getElementById('name') as HTMLInputElement | null;
        const emailInput = document.getElementById('email') as HTMLInputElement | null;
        const tshirtSizeInput = document.getElementById('tshirtSize') as HTMLSelectElement | null;
        const phoneInput = document.getElementById('phone') as HTMLInputElement | null;
        const referrerInput = document.getElementById('referrer') as HTMLInputElement | null;
        const buttonLabelInput = document.getElementById('buttonLabel') as HTMLInputElement | null;
        const pageSourceInput = document.getElementById('pageSource') as HTMLInputElement | null;

        const name = nameInput ? nameInput.value.trim() : '';
        const email = emailInput ? emailInput.value.trim() : '';
        const tshirtSize = tshirtSizeInput ? tshirtSizeInput.value : '';
        const phone = phoneInput ? phoneInput.value.trim() : '';
        const referrer = referrerInput ? referrerInput.value : '';
        const buttonLabel = buttonLabelInput ? buttonLabelInput.value : '';
        const pageSource = pageSourceInput ? pageSourceInput.value : '';

        let hasErrors = false;

        // Validate name
        if (!name) {
          const nameError = document.getElementById('name-error');
          if (nameError) nameError.textContent = 'This field is mandatory';
          if (nameInput) nameInput.classList.add('error');
          hasErrors = true;
        }

        // Validate email
        if (!email) {
          const emailError = document.getElementById('email-error');
          if (emailError) emailError.textContent = 'This field is mandatory';
          if (emailInput) emailInput.classList.add('error');
          hasErrors = true;
        } else if (!/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)) {
          const emailError = document.getElementById('email-error');
          if (emailError) emailError.textContent = 'Please enter a valid email address';
          if (emailInput) emailInput.classList.add('error');
          hasErrors = true;
        }

        // Validate tshirtSize
        if (!tshirtSize) {
          const tshirtSizeError = document.getElementById('tshirtSize-error');
          if (tshirtSizeError) tshirtSizeError.textContent = 'This field is mandatory';
          if (tshirtSizeInput) tshirtSizeInput.classList.add('error');
          hasErrors = true;
        }

        if (hasErrors) {
          console.log('Form has errors, not proceeding');
          return;
        }

        if (typeof window !== 'undefined' && (window as any).posthog) {
          (window as any).posthog.capture('sps_discount_form_submitted', {
            name,
            email,
            tshirtSize,
            phone,
            referrer,
            buttonLabel,
            pageSource
          });
        }
        
        console.log('Form validation passed, showing thank you message');
        // Show thank you message
        const formContainer = document.querySelector('.get-started-form-container');
        console.log('Form container found:', formContainer);
        if (formContainer) {
          formContainer.innerHTML = `
            <div style="text-align: center; padding: 1.5rem 0;">
              <div class="anonymous-ai-headline" style="margin-bottom: 1rem; font-size: 2rem; font-weight: normal;">You're All Set!</div>
              <div class="anonymous-ai-subheadline" style="font-size: 1.1rem; color: #444; line-height: 1.6; margin-bottom: 2rem;">
                You've secured your t-shirt and 20% off voucher.<br>
                We'll be in touch soon to understand where to send it.
              </div>
              
              <div class="anonymous-ai-headline" style="margin-bottom: 1.5rem; font-size: 1.5rem; font-weight: 600;">Get Started on your first survey</div>
              <div style="display: flex; justify-content: center; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap;">
                <a href="https://hoogly.page.link/viVj6EGk4E8mqqYdA" target="_blank" rel="noopener noreferrer">
                  <img src="/images/App Store.png" alt="Download on the App Store" style="height: 50px; width: auto; cursor: pointer;" />
                </a>
                <a href="https://hoogly.page.link/viVj6EGk4E8mqqYdA" target="_blank" rel="noopener noreferrer">
                  <img src="/images/Play Store.png" alt="GET IT ON Google Play" style="height: 50px; width: auto; cursor: pointer;" />
                </a>
              </div>
              
              <hr style="border: none; height: 1px; background-color: #e0e0e0; margin: 2rem 0;" />
              
              <div class="anonymous-ai-subheadline" style="font-size: 1.1rem; color: #444; line-height: 1.6; margin-bottom: 1.5rem;">
                Join our <span style="color: #ff8661; font-weight: 600;">Human at Work</span> Community
              </div>
              <a href="https://join.slack.com/t/humanatworkgroup/shared_invite/zt-3ac8dkoh1-4jDbzie5we~4Z90zectWsw" target="_blank" rel="noopener noreferrer">
                <img src="/images/Slack QR Code.png" alt="Slack QR Code" style="max-width: 150px; height: auto; margin: 0 auto; display: block; border: 2px solid #e6e1fa; border-radius: 12px; cursor: pointer;" />
              </a>
            </div>
          `;
          
          // Add Calendly section after the form container
          const calendlySection = document.createElement('div');
          calendlySection.style.cssText = 'max-width: 500px; margin: 2rem auto 0 auto;';
          calendlySection.innerHTML = `
            <div class="anonymous-ai-headline" style="margin-bottom: 1rem; font-size: 2rem; font-weight: 400; text-align: center;">Want to find out more about Hoogly?</div>
            <div id="calendly-inline-widget" style="min-width: 320px; height: 1100px;"></div>
          `;
          formContainer.parentNode?.insertBefore(calendlySection, formContainer.nextSibling);
          
          // Initialize Calendly widget
          if (typeof window !== 'undefined' && (window as any).Calendly) {
            (window as any).Calendly.initInlineWidget({
              url: 'https://calendly.com/hoogly/30min',
              parentElement: document.getElementById('calendly-inline-widget'),
              prefill: {},
              utm: {}
            });
          }
        }
      });
    }
  </script>
  
  <!-- Calendly inline widget script -->
  <script type="text/javascript" src="https://assets.calendly.com/assets/external/widget.js" async></script>
</Layout> 